---
title: "red_wine_exploration"
author: "Brahma Reddy Chilakala"
date: "8 August 2016"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
library(ggplot2)

```
```{r echo=FALSE, Load_the_Data}
# Load the Data
red_wine <- read.csv('wineQualityReds.csv')
```
## Structure of Dataset
```{r echo=FALSE, Str of Dataset}
str(red_wine)
```
There are total 1599 rows and 13 columns are there.
## Names of variables
```{r echo=FALSE, Names of variables}
names(red_wine)
```
## Head of Dataset
```{r echo=FALSE, Head of Dataset}
head(red_wine)
```
## Summary
```{r echo=FALSE, Summary}
summary(red_wine)
```
Our target variable is Quality, which has min 3.000, max 8.000 and Mean of 5.636.
# Univariate Plots Section
Now we will explore each feature independently
## Quality
Quality is our target variable.
```{r echo=FALSE}
summary(red_wine$quality)
```
quality has min 3.00, max 8.00 and Mean 5.636.
Let's draw a histogram of quality
```{r}
ggplot(aes(x=quality), data = red_wine) +
  geom_bar()
```
Most of the wines have quality either 5 or 6. Very few wines have quality 3 or 8.
How much percent of wines have quality 5 or 6?
```{r echo=FALSE}
sum(red_wine$quality == 5 | red_wine$quality == 6)/nrow(red_wine)
```
82.5% total wines have quality as 5 or 6.
## fixed.acidity
```{r echo=FALSE}
summary(red_wine$fixed.acidity)
```

```{r echo=FALSE}
ggplot(aes(x=fixed.acidity), data = red_wine) +
  geom_histogram()
```
## volatile.acidity
```{r echo=FALSE}
summary(red_wine$volatile.acidity)
```

```{r echo=FALSE}
ggplot(aes(x=volatile.acidity), data = red_wine) +
  geom_histogram()
```
## citric.acid
```{r echo=FALSE}
summary(red_wine$citric.acid)
```

```{r echo=FALSE}
ggplot(aes(x=citric.acid), data = red_wine) +
  geom_histogram()
```
```{r echo=FALSE}
ggplot(aes(x=citric.acid), data = red_wine) +
  geom_histogram(binwidth = 0.01)
```
There is a big spike when citric.acid is 0.00. Total there are there major peaks at 0.00, 0.25 and 0.50. After 0.50 the count starts reducing.
How many wines have citric acid = 0?
```{r echo=FALSE}
sum(red_wine$citric.acid == 0)
```
There are 132 wines that have 0 citric acid.
## residual.sugar
```{r echo=FALSE}
summary(red_wine$residual.sugar)
```
```{r echo=FALSE}
ggplot(aes(x=residual.sugar), data = red_wine) +
  geom_histogram()
```
residual.sugar has extreme outliers. Let's use boxplot to explore more about this feature.
```{r echo=FALSE}
ggplot(aes(x = 1, y = residual.sugar), data = red_wine) +
  geom_boxplot()
```
mean of residual.sugar is 2.539. But there are some values that have residual.sugar 15.500. Most of the values are below 4.000
## chlorides
```{r echo=FALSE}
summary(red_wine$chlorides)
```
mean is 0.08747 and max is 0.61100. There is huge gap between these two.
```{r echo=FALSE}
ggplot(aes(x=chlorides), data = red_wine) +
  geom_histogram()
```
Most of the wines have less than 0.2 chlorides
## free.sulfur.dioxide
```{r echo=FALSE}
summary(red_wine$free.sulfur.dioxide)
```
mean is 15.87 and max is 72.00.
```{r echo=FALSE}
ggplot(aes(x=free.sulfur.dioxide), data = red_wine) +
  geom_histogram()
```
This is positively skewed. Let's log transform these values.
```{r echo=FALSE}
ggplot(aes(x=free.sulfur.dioxide), data = red_wine) +
  geom_histogram() +
  scale_x_log10()
```
This doesn't seem to follow any particular pattern. Let's leave it now.
## total.sulfur.dioxide
```{r echo=FALSE}
summary(red_wine$total.sulfur.dioxide)
```
Mean is 46.47 and Max is 289.00.
```{r echo=FALSE}
ggplot(aes(x=total.sulfur.dioxide), data = red_wine) +
  geom_histogram()
```
This distribution is positively skewed. Most of the values are less than 160.
Let's log transform this.
```{r echo=FALSE}
ggplot(aes(x=total.sulfur.dioxide), data = red_wine) +
  geom_histogram() +
  scale_x_log10()
```
Log transform appears to be normally distributed.
## density
```{r echo=FALSE}
summary(red_wine$density)
```
```{r echo=FALSE}
ggplot(aes(x=density), data = red_wine) +
  geom_histogram()
```
density is normally distributed.
## pH
```{r echo=FALSE}
summary(red_wine$pH)
```
```{r echo=FALSE}
ggplot(aes(x=pH), data = red_wine) +
  geom_histogram()
```
The histogram plot shows pH is normally distributed at Mean 3.311 and most values are in between 3.0 and 3.6
## sulphates
```{r echo=FALSE}
summary(red_wine$sulphates)
```
```{r echo=FALSE}
ggplot(aes(x=sulphates), data = red_wine) +
  geom_histogram()
```
This looks normally distributed, but some values are very high which makes this somewhat skewed.
```{r echo=FALSE}
ggplot(aes(x=sulphates), data = red_wine) +
  geom_histogram(binwidth = 0.01) +
  xlim(0,1.25)
```
Now the histogram looks normally distributed.
## alcohol
```{r echo=FALSE}
summary(red_wine$alcohol)
```
```{r echo=FALSE}
ggplot(aes(x=alcohol), data = red_wine) +
  geom_histogram()
```
Let's change binwidth to get more clarity
```{r echo=FALSE}
ggplot(aes(x=alcohol), data = red_wine) +
  geom_histogram(binwidth = 0.1)
```
This is positively skewed. Let's log transform this.
```{r echo=FALSE}
ggplot(aes(x=alcohol), data = red_wine) +
  geom_histogram() +
  scale_x_log10()
```
Most of the values are in between 9.50 and 11.10
# Univariate Analysis

### What is the structure of your dataset?

### What is/are the main feature(s) of interest in your dataset?

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

# Bivariate Plots Section
```{r echo=FALSE}
red_wine$quality.factor <- as.factor(red_wine$quality)
```
## quality vs fixed.acidity
```{r echo=FALSE}
with(red_wine, cor.test(quality, fixed.acidity))
```
Only 12% correlation is between these variables
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=fixed.acidity), data = red_wine) + geom_boxplot()
```
The figure shows a complex relationship between Quality and Fixed.acidity. There doesn't seem to be significant pattern between the two.
## quality vs volatile.acidity
```{r echo=FALSE}
with(red_wine, cor.test(quality, volatile.acidity))
```
There is approximately 40% negative correlation between the quality and volatile.acidity
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=volatile.acidity), data = red_wine) + geom_boxplot()
```
It seems that high quality wines have lower volatile.acidity levels
## quality vs citric.acid
```{r echo=FALSE}
with(red_wine, cor.test(quality, citric.acid))
```
There is only 22% correlation between quality and citric.acid
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=citric.acid), data = red_wine) + geom_boxplot()
```
The plot shows high quality wines tends to have high citric acid. But there are some outliers in quality 7, which have approximately 0.00 citric.acid and one value with 1.00 have quality 4.
## quality vs residual.sugar
```{r echo=FALSE}
with(red_wine, cor.test(quality, residual.sugar))
```
There is only 1% correlation between quality and residual.sugar
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=residual.sugar), data = red_wine) + geom_boxplot()
```
There doesn't seem to be a relationship between quality and residual.sugar
## quality vs chlorides
```{r echo=FALSE}
with(red_wine, cor.test(quality, chlorides))
```
There is 12% negative correlation between quality and chlorides
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=chlorides), data = red_wine) + geom_boxplot()
```
Overall not that much difference. But high quality wine contains less chlorides and low quality wine contains high chlorides
## quality vs free.sulfur.dioxide
```{r echo=FALSE}
with(red_wine, cor.test(quality, free.sulfur.dioxide))
```
There is 5% negative correlation between quality and free.sulfur.dioxide
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=free.sulfur.dioxide), data = red_wine) + geom_boxplot()
```
We can't infer anything about relationship between these two.
## quality vs total.sulfur.dioxide
```{r}
with(red_wine, cor.test(quality, total.sulfur.dioxide))
```
There is 18% negative correlation between quality and total.sulfur.dioxide
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=total.sulfur.dioxide), data = red_wine) + geom_boxplot()
```
Same as above, we can't infer anything from figure.
## quality vs density
```{r echo=FALSE}
with(red_wine, cor.test(quality, density))
```
There is 17% negative correlation between quality and density
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=density), data = red_wine) + geom_boxplot()
```
the plot shows high quality wine tends to have low density
## quality vs pH
```{r echo=FALSE}
with(red_wine, cor.test(quality, pH))
```
There is 5% negative correlation between quality and pH
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=pH), data = red_wine) + geom_boxplot()
```
mean pH is entirely between 3.2 and 3.4 for all different quality wines. This does not affect quality of wines.
## quality vs sulphates
```{r echo=FALSE}
with(red_wine, cor.test(quality, sulphates))
```
There is 25% correlation between quality and sulphates
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=sulphates), data = red_wine) + geom_boxplot()
```
High quality wines tends to have more sulphates
## quality vs alcohol
```{r echo=FALSE}
with(red_wine, cor.test(quality, alcohol))
```
There is 47% correlation between quality and alcohol
```{r echo=FALSE}
ggplot(aes(x=quality.factor, y=alcohol), data = red_wine) + geom_boxplot()
```
Hig quality wines have higher alcohol levels.
